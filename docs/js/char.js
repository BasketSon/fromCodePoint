let symbolFontSize=1.8;const Char=function(t){this.codePoint=t,this.size=symbolFontSize,this.utfSymbol=String.fromCodePoint(t),this.node=this.createNode()};function decToHexWithPad(t){let e=Number(t).toString(16);return t<=9999?`000${e}`.substr(-4):e}Char.prototype.createNode=function(){let t=document.createElement("button");return t.classList.add("char"),t.setAttribute("title",`Dec code is ${this.codePoint}`),t.textContent=this.utfSymbol,t.style.fontSize=`${this.size}em`,t},Char.prototype.render=function(t){t.appendChild(this.node)},Char.prototype.renderIcon=function(){let t=this.utfSymbol;this.node.addEventListener("click",function(){updateFavicon(t)})},Char.prototype.resize=function(t){this.size=t?this.size<4?this.size+.2:4:this.size>1?this.size-.2:1,this.node.style.fontSize=`${this.size}em`,symbolFontSize=this.size},Char.prototype.copyToClipboard=function(){let t=this.utfSymbol,e=this.codePoint;this.node.addEventListener("click",function(n){let o=n.shiftKey?`\\u${decToHexWithPad(e)}`:t;typeCopiedSymbol(o),navigator.clipboard.writeText(o).then(()=>{console.log(o+" скопировано в буфер")}).catch(t=>{console.log("Ошибка",t)})})},Char.prototype.playKeySound=function(){this.node.addEventListener("click",function(){playClickSound()})};let lastSetEnd,lastSetStart,charList=[];function createSet(t,e){let n=new DocumentFragment;charList=[];for(let o=t;o<=e;o++){let t=new Char(o);charList.push(t),t.render(n),t.copyToClipboard(),t.playKeySound(),t.renderIcon()}return lastSetStart=t,lastSetEnd=e,n}const charsField=document.querySelector(".chars");function drawSet(t,e){charsField.appendChild(createSet(t,e))}function removeChars(){document.querySelectorAll(".char").forEach(function(t){t.remove()})}function newSet(){let t=getButtonsAmount()?getButtonsAmount():300;removeChars();let e=+prompt("С индекса",lastSetEnd||0);drawSet(e,+prompt("По индекс",e+t))}function nextSet(){let t=getButtonsAmount();removeChars();let e=lastSetEnd||0;drawSet(e,t?e+t:e+300)}function prevSet(){if(!lastSetStart)return!1;let t=getButtonsAmount();removeChars(),drawSet(lastSetStart-t>0?lastSetStart-t:0,lastSetStart)}function getButtonsAmount(){let t=charsField.offsetHeight*charsField.offsetWidth,e=document.querySelectorAll(".char:nth-child(3n)"),n=Array.from(e).reduce((t,e)=>t+(e.offsetHeight+20)*(e.offsetWidth+30),0)/e.length;return Math.floor(t/n)}let newSetButton=document.querySelector(".new-set");newSetButton.addEventListener("click",newSet),window.addEventListener("keydown",function(t){switch(t.which){case 68:case 39:nextSet();break;case 65:case 37:prevSet();break;case 87:case 38:charList.forEach(function(t){t.resize("up")});break;case 83:case 40:charList.forEach(function(t){t.resize()})}});let clickAudio=new Audio;function playClickSound(){let t=clickAudio.cloneNode();t.currentTime=.2,t.volume=.2,t.play(),t.loop=!1}clickAudio.src="../media/click.mp3",clickAudio.preload="auto";const log=document.querySelector(".log");function typeCopiedSymbol(t){log.textContent+=`${t} `,log.textContent.split(" ").length>30&&(log.textContent=log.textContent.split(" ").slice(-30).join(" "))}const canvas=document.querySelector("#iconCanvas"),ctx=canvas.getContext("2d"),link=document.querySelector('link[rel="icon"]');function updateFavicon(t){console.log(t),ctx.clearRect(0,0,16,16),ctx.fillText(String(t),canvas.width/2,canvas.height-3),link.href=canvas.toDataURL("image/png")}ctx.font="14px Arial",ctx.textAlign="center",ctx.fillText("🚳",canvas.width/2,canvas.height-3),link.href=canvas.toDataURL("image/png");